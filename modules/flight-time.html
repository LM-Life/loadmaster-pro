<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, viewport-fit=cover" name="viewport"/>
<title>Flight Time Calculator</title>
<link href="../style.css" rel="stylesheet"/>
<style>
    .container {
      max-width: 820px;
      margin: 0 auto;
      padding: 6px 10px;
    }

    .home-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      -webkit-tap-highlight-color: transparent;
      margin: 2px 0 8px;
    }

    .module-title {
      margin: 0 0 8px;
      font-size: 30px;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-weight: 950;
      line-height: 1.05;
    }

    .card {
      border: 1px solid rgba(255, 255, 255, 0.14);
      border-radius: 16px;
      padding: 8px;
      background: rgba(255, 255, 255, 0.04);
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.30);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .time-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    /* Keep 2 columns on iPhone to reduce scroll; fall back only on very narrow screens */
    @media (max-width: 340px) {
      .time-grid {
        grid-template-columns: 1fr;
      }
    }

    label {
      display: block;
      font-weight: 900;
      margin: 0 0 4px;
      letter-spacing: .02em;
    }

    input,
    select,
    button {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      background: rgba(10, 14, 20, 0.35);
      color: #fff;
      font-size: 16px;
      box-sizing: border-box;
      min-height: 44px;
    }

    button {
      font-weight: 950;
      cursor: pointer;
    }

    .time-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .time-row input {
      width: 100%;
    }

    .mini {
      flex: 0 0 auto;
      width: 100%;
      min-width: 100%;
      padding: 10px 10px;
      font-weight: 950;
    }

    .zulu-line {
      margin-top: 8px;
      font-size: 14px;
      opacity: .92;
    }

    .result-card {
      margin-top: 8px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(10, 14, 20, 0.52);
      padding: 8px;
    }

    .result-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 6px;
    }

    .result-top .label {
      font-weight: 950;
      letter-spacing: .10em;
      text-transform: uppercase;
      opacity: .9;
      font-size: 12px;
    }

    .badge {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      font-size: 12px;
      opacity: .9;
      white-space: nowrap;
    }

    .result-main {
      font-size: 44px;
      font-weight: 950;
      line-height: 1;
      margin: 0 0 4px;
    }

    .result-sub {
      font-size: 12.5px;
      opacity: .92;
      line-height: 1.2;
    }

    .helper {
      margin-top: 4px;
      font-size: 12.5px;
      opacity: .92;
      line-height: 1.3;
    }

    .error {
      opacity: 1;
      font-weight: 950;
    }

    .actions {
      margin-top: 8px;
      border-top: 1px solid rgba(255, 255, 255, 0.10);
      padding-top: 8px;
    }

    .action-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .action-grid+.action-grid {
      margin-top: 8px;
    }

    @media (max-width: 340px) {
      .action-grid {
        grid-template-columns: 1fr;
      }
    }

    details.conv {
      margin-top: 8px;
    }

    details.conv summary {
      cursor: pointer;
      list-style: none;
      padding: 7px 10px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(255, 255, 255, 0.05);
      font-weight: 950;
    }

    details.conv summary::-webkit-details-marker {
      display: none;
    }

    details.conv .conv-body {
      padding: 10px 4px 2px;
      font-size: 13px;
      opacity: .92;
      line-height: 1.35;
    }

    /* iPhone tighten */
    @media (max-width: 430px) {
      .module-title {
        font-size: 28px;
        margin-bottom: 10px;
      }

      .card {
        padding: 10px;
      }

      input,
      select,
      button {
        padding: 10px 12px;
      }

      .result-main {
        font-size: 42px;
      }

      .mini {
        min-width: 78px;
      }
    }
  

    /* --- Compact layout tweaks (Feb 2026) --- */
    .module-title { margin: 0 0 10px; font-size: 30px; }
    .card { padding: 14px; }
    .time-grid { gap: 12px; margin-top: 8px; }
    .time-col { gap: 8px; }
    .time-row { gap: 10px; }
    .actions { margin-top: 12px; }
    .action-grid { gap: 10px; margin-top: 10px; }
    .btn { padding: 12px 12px; min-height: 46px; }
    .zulu-line { margin-top: 10px; }
    .result-card { margin-top: 12px; }
    .helper { margin: 12px 0 10px; }
    .conv { margin-top: 10px; }

/* Leg list inside result card */
.legs-list{ margin-top:10px; display:flex; flex-direction:column; gap:6px; }
.leg-row{ display:flex; justify-content:space-between; font-size:14px; opacity:0.95; }
.leg-row.current{ opacity:1; }
.leg-label{ font-weight:700; }
.leg-val{ font-variant-numeric: tabular-nums; }
</style>
</head>
<body>
<div class="container">
<a aria-label="Home" class="home-button" href="../index.html">
<span class="home-icon">üè†</span><span>Home</span>
</a>
<h1 class="module-title">FLIGHT TIME<br/>CALCULATOR</h1>
<div aria-label="Flight Time Calculator" class="card" role="region">
<div class="time-grid">
<div class="time-col">
<div class="label">Takeoff (Z)</div>
<input class="time-input" id="startTime" inputmode="numeric" maxlength="5" pattern="[0-9]*" placeholder="HH:MM" type="text" value="00:00"/>
<button class="btn primary btn-now" id="nowStart" onclick="setNow('startTime')" type="button">Now (Z)</button>
</div>
<div class="time-col">
<div class="label">Landing (Z)</div>
<input class="time-input" id="endTime" inputmode="numeric" maxlength="5" pattern="[0-9]*" placeholder="HH:MM" type="text" value="00:00"/>
<button class="btn primary btn-now" id="nowEnd" onclick="setNow('endTime')" type="button">Now (Z)</button>
</div>
</div>
<div class="actions">
<div class="action-grid">
<button class="btn primary" id="btnCalc" onclick="calc()" type="button">Calculate</button>
<button class="btn" id="btnClear" onclick="clearAll()" type="button">Clear</button>
</div>
<div class="action-grid">
<button class="btn primary" id="btnAddLeg" onclick="addLeg()" type="button">Add Leg</button>
<button class="btn" id="btnResetLegs" onclick="resetLegs()" type="button">Reset Legs</button>
</div>
</div>
<div class="zulu-line" id="zuluClock">Zulu: --:--:--Z</div>
<div aria-label="Results" class="result-card">
<div class="result-top">
<div class="label">Flight Time</div>
<span class="badge">Zulu ‚Ä¢ HH.MM</span>
</div>
<div class="result-main" id="resultMain">‚Äî</div>
<div class="result-sub" id="resultSub"></div>
<div class="result-sub" id="details" style="margin-top: 4px"></div>
<div class="result-sub" id="note"></div>
<div class="result-sub" id="legs" style="margin-top: 6px"></div>
<div class="result-sub" id="rollover" style="margin-top: 4px; font-weight: 950"></div>
</div>
<div class="helper"><span class="badge">Time Format</span> 24‚Äëhour clock (HH:MM) in Zulu only.</div>
<details class="conv">
<summary>Minutes ‚Üí Decimal Conversion (TO table)</summary>
<div class="conv-body subtle">
              1‚Äì2 = .0
              3‚Äì8 = .1
             9‚Äì14 = .2
            15‚Äì20 = .3
            21‚Äì26 = .4
            27‚Äì33 = .5
            34‚Äì39 = .6
            40‚Äì45 = .7
            46‚Äì51 = .8
            52‚Äì57 = .9
            58‚Äì60 = Next hour
          </div>
</details>
</div>
</div>
<script>

    // Conversion table from your photo
    function convertMinutes(min) {
      // min: 0-60
      min = Math.max(0, Math.min(60, Math.floor(min || 0)));

      if (min >= 58) return { dec: 0.0, addHour: true, band: "58‚Äì60 = Next hour" };
      if (min <= 2) return { dec: 0.0, band: "1‚Äì2 = .0" };
      if (min <= 8) return { dec: 0.1, band: "3‚Äì8 = .1" };
      if (min <= 14) return { dec: 0.2, band: "9‚Äì14 = .2" };
      if (min <= 20) return { dec: 0.3, band: "15‚Äì20 = .3" };
      if (min <= 26) return { dec: 0.4, band: "21‚Äì26 = .4" };
      if (min <= 33) return { dec: 0.5, band: "27‚Äì33 = .5" };
      if (min <= 39) return { dec: 0.6, band: "34‚Äì39 = .6" };
      if (min <= 45) return { dec: 0.7, band: "40‚Äì45 = .7" };
      if (min <= 51) return { dec: 0.8, band: "46‚Äì51 = .8" };
      if (min <= 57) return { dec: 0.9, band: "52‚Äì57 = .9" };
      return { dec: 0.0, band: "0 = .0" };
    }

    function parseHHMM(value) {
      // value like "14:55"
      if (!value || typeof value !== "string") return null;
      const m = value.match(/^([01]\d|2[0-3]):([0-5]\d)$/);
      if (!m) return null;
      return { h: Number(m[1]), min: Number(m[2]) };
    }

    function minutesSinceMidnight(t) {
      return (t.h * 60) + t.min;
    }
function computeCurrentLegMeta() {
  const startStr = document.getElementById("startTime").value.trim();
  const endStr   = document.getElementById("endTime").value.trim();

  const start = parseHHMM(startStr);
  const end   = parseHHMM(endStr);
  if (!start || !end) return null;

  let startMin = minutesSinceMidnight(start.h, start.m);
  let endMin   = minutesSinceMidnight(end.h, end.m);

  // handle rollover across midnight
  if (endMin < startMin) endMin += 24 * 60;

  const diff = endMin - startMin;
  const hh = Math.floor(diff / 60);
  const mm = diff % 60;

  const conv = convertMinutes(mm);
  const dec = (hh + (conv.addHour ? 1 : 0)) + conv.dec;

  const hhmm = `${hh}:${String(mm).padStart(2, "0")}`;

  return { hh, mm, hhmm, conv, decimal: dec };
}

// renderLegs implemented above




    function calc() {
      const s = parseHHMM(document.getElementById("startTime").value);
      const e = parseHHMM(document.getElementById("endTime").value);

      const resultEl = document.getElementById("resultMain");
      const noteEl = document.getElementById("note");

      noteEl.classList.remove("error");

      if (!s || !e) {
        resultEl.textContent = "‚Äî";
        const subEl = document.getElementById("resultSub");
        if (subEl) subEl.textContent = "Enter times in HH:MM.";
        noteEl.textContent = "";
        return;
      }

      let start = minutesSinceMidnight(s);
      let end = minutesSinceMidnight(e);

      // If landing is earlier than takeoff, assume it landed next day
      let rollover = false;
      if (end < start) { end += 24 * 60; rollover = true; }

      let baseDiff = end - start; // minutes
      let diff = baseDiff + legs.reduce((a, b) => a + b, 0);
      let hours = Math.floor(diff / 60);
      let mins = diff % 60;

      const conv = convertMinutes(mins);
      if (conv.addHour) {
        hours += 1;
      }

      const total = (hours + (conv.dec || 0)).toFixed(1);
      resultEl.textContent = "" + total;

      const rolloverEl = document.getElementById('rollover');
      rolloverEl.textContent = rollover ? '+1 DAY (UTC rollover)' : '';

      if (conv.addHour) {
        noteEl.textContent = "Minutes 58‚Äì60 round to next hour (+1.0).";
      } else {
        noteEl.textContent = `Minutes ${mins} ‚Üí ${conv.band}`;
        const subEl = document.getElementById("resultSub");
        if (subEl) subEl.textContent = `Elapsed: ${hours}:${String(mins).padStart(2, "0")} (H:MM)`;
      }
    }

    function pad2(n) { return String(n).padStart(2, '0'); }

    function getNowZuluHHMM() {
      const d = new Date();
      return pad2(d.getUTCHours()) + ":" + pad2(d.getUTCMinutes());
    }

    function setNowZ(targetId) {
      const v = getNowZuluHHMM();
      document.getElementById(targetId).value = v;
      calc();
    }

    function updateZuluClock() {
      const d = new Date();
      const z = pad2(d.getUTCHours()) + ":" + pad2(d.getUTCMinutes()) + ":" + pad2(d.getUTCSeconds()) + "Z";
      const el = document.getElementById("zuluClock");
      if (el) el.textContent = "Current Zulu: " + z;
    }

    // Auto-format HHMM -> HH:MM while typing
    function autoFormatTime(el) {
      let v = el.value.replace(/[^0-9]/g, '');
      if (v.length >= 3) {
        v = v.slice(0, 2) + ":" + v.slice(2, 4);
      }
      el.value = v.slice(0, 5);
    }

    ["startTime", "endTime"].forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener("input", () => autoFormatTime(el));
    });

    let legs = []; // decimal flight-time legs (e.g., 2.1)

    function diffMinutes(s, e) {
      let start = s.h * 60 + s.min;
      let end = e.h * 60 + e.min;
      let rollover = false;
      if (end < start) { end += 1440; rollover = true; }
      return { mins: end - start, rollover };
    }

    function addLeg() {
      const s = parseHHMM(startTime.value);
      const e = parseHHMM(endTime.value);
      if (!s || !e) return;
      const d = diffMinutes(s, e);
      legs.push(d.mins);
      renderLegs();
      calc();
    }

    function resetLegs() {
      legs = [];
      renderLegs();
      calc();
    }

    function renderLegs() {
      const el = document.getElementById("legs");
      if (!legs.length) { el.textContent = ""; return; }
      el.textContent = "Legs: " + legs.join(" + ");
    }

    function clearAll() {
  document.getElementById("startTime").value = "00:00";
  document.getElementById("endTime").value = "00:00";
  legs = [];
  document.getElementById("resultMain").textContent = "0.0";

  const subEl = document.getElementById("resultSub");
  if (subEl) subEl.textContent = "Elapsed: 0:00 (H:MM)";

  const detailsEl = document.getElementById("details");
  if (detailsEl) detailsEl.textContent = "";

  const noteEl = document.getElementById("note");
  if (noteEl) noteEl.textContent = "Minutes ‚Üí Decimal";

  renderLegs(null);
}

    // Auto-calc on change for convenience
    ["startTime", "endTime"].forEach(id => {
      document.getElementById(id).addEventListener("change", calc);
    });

    // Zulu clock
    updateZuluClock();
    setInterval(updateZuluClock, 1000);

    // Initial example calc
    calc();
  
</script>
</body>
</html>
